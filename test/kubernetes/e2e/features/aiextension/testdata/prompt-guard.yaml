apiVersion: gateway.kgateway.dev/v1alpha1
kind: RoutePolicy
metadata:
  name: azure-openai-opt
  namespace: ai-test
spec:
  targetRefs:
  - group: gateway.networking.k8s.io
    kind: HTTPRoute
    name: azure-openai
  options:
    ai:
      promptGuard:
        request:
          moderation:
            openai:
              authToken:
                secretRef:
                  name: openai-secret
                  namespace: ai-test
          regex:
            builtins:
            - PHONE_NUMBER
            - EMAIL
            - SSN
            - CREDIT_CARD
        response:
          regex:
            builtins:
            - PHONE_NUMBER
            - EMAIL
            - SSN
            - CREDIT_CARD
---
apiVersion: gateway.kgateway.dev/v1alpha1
kind: RoutePolicy
metadata:
  name: openai-opt
  namespace: ai-test
spec:
  targetRefs:
  - group: gateway.networking.k8s.io
    kind: HTTPRoute
    name: openai
  options:
    ai:
      promptGuard:
        request:
          customResponse:
            message: "{ \"message\": \"Please provide a valid input.\" }"
            statusCode: 400
          regex:
            action: REJECT
            builtins:
            - PHONE_NUMBER
            - EMAIL
            - SSN
            - CREDIT_CARD
        response:
          regex:
            builtins:
            - PHONE_NUMBER
            - EMAIL
            - SSN
            - CREDIT_CARD
---
apiVersion: gateway.kgateway.dev/v1alpha1
kind: RoutePolicy
metadata:
  name: gemini-opt
  namespace: ai-test
spec:
  targetRefs:
  - group: gateway.networking.k8s.io
    kind: HTTPRoute
    name: gemini
  options:
    ai:
      promptGuard:
        request:
          regex:
            action: REJECT
            builtins:
            - PHONE_NUMBER
            - EMAIL
            - SSN
            - CREDIT_CARD
        response:
          regex:
            builtins:
            - PHONE_NUMBER
            - EMAIL
            - SSN
            - CREDIT_CARD
---
apiVersion: gateway.kgateway.dev/v1alpha1
kind: RoutePolicy
metadata:
  name: vertex-ai-opt
  namespace: ai-test
spec:
  targetRefs:
  - group: gateway.networking.k8s.io
    kind: HTTPRoute
    name: vertex-ai
  ai:
    promptGuard:
      request:
        regex:
          action: REJECT
          builtins:
          - PHONE_NUMBER
          - EMAIL
          - SSN
          - CREDIT_CARD
      response:
        regex:
          builtins:
          - PHONE_NUMBER
          - EMAIL
          - SSN
          - CREDIT_CARD