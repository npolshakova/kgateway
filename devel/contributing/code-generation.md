# Code Generation

To run the full codegen process, use `make generate-all -B`. In most cases it is not necessary to run all sub-targets within `generate-all`.

Here is a description of each sub-target and its purpose:

| Target | Description | Use when... | Approximate runtime |
|----------------------------|:-------------------------------------------------------------------------------------------------------------------------------|:-------------------------------------------------------------------------------------|--------------------------------------|
| `verify` | Runs codegen (`generate-all`) and returns an error if it resulted in any files changed (this typically means that there are generated files that you have not committed) | You are about to open a PR and want to verify whether you need to re-generate any code | 4-5m |
| `generate-all` or `generated-code` | Generates all required code, cleaning and formatting as well; this target is executed in CI | You need to run all codegen steps without human error (e.g. prior to PR merge) | 4-5m |
| `go-generate-all` | Calls `go-generate-apis` and `go-generate-mocks` | There is an API change | 3-5m |
| `go-generate-apis` | Invokes all generate directives in the [hack](/hack) directory | There is an API change | 1m |
| `go-generate-mocks` | Invokes all mockgen generate directives in the repo | There is an interface API change | 2:30-3m |
| `mod-download` | Calls `go mod download all` | Dependencies are not all present locally | 1s (if deps are already downloaded) |
| `mod-tidy` | Calls `go mod tidy` | Dependencies have been added, updated, or removed | 1-2s |
| `fmt` | Runs [`goimports`](https://pkg.go.dev/golang.org/x/tools/cmd/goimports) which updates imports and formats code | Code has been modified (any change, in case it's not properly formatted) | 9-13s |
| `clean-gen` | Removes files generated by codegen | An existing generated file may no longer be generated by codegen (rare) | 3s |
| `generate-licenses` | Generates docs files containing attribution for all dependencies which require it | There is a new dependency or a depency bump | 7-12s |
