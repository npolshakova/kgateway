Clusters:
  - connectTimeout: 5s
    edsClusterConfig:
      edsConfig:
        ads: {}
        resourceApiVersion: V3
    ignoreHealthOnHostRemoval: true
    metadata: {}
    name: kube_default_example-svc_80
    type: EDS
  - connectTimeout: 5s
    metadata: {}
    name: test-backend-plugin_default_example-svc_80
Listeners:
  - address:
      socketAddress:
        address: '::'
        ipv4Compat: true
        portValue: 80
    filterChains:
      - filters:
          - name: envoy.filters.network.http_connection_manager
            typedConfig:
              '@type': type.googleapis.com/envoy.extensions.filters.network.http_connection_manager.v3.HttpConnectionManager
              httpFilters:
                - name: envoy.filters.http.rbac
                  disabled: true
                  typedConfig:
                    '@type': type.googleapis.com/envoy.extensions.filters.http.rbac.v3.RBAC
                - name: envoy.filters.http.router
                  typedConfig:
                    '@type': type.googleapis.com/envoy.extensions.filters.http.router.v3.Router
              mergeSlashes: true
              normalizePath: true
              rds:
                configSource:
                  ads: {}
                  resourceApiVersion: V3
                routeConfigName: listener~80
              statPrefix: http
              useRemoteAddress: true
        name: listener~80
    metadata:
      filterMetadata:
        merge.TrafficPolicy.gateway.kgateway.dev:
          rbac:
            - gateway.kgateway.dev/TrafficPolicy/default/parent-gateway-test
    name: listener~80
Routes:
  - ignorePortInHostMatching: true
    metadata:
      filterMetadata:
        merge.TrafficPolicy.gateway.kgateway.dev:
          rbac:
            - gateway.kgateway.dev/TrafficPolicy/default/parent-gateway-test
    name: listener~80
    typedPerFilterConfig:
      envoy.filters.http.rbac:
        '@type': type.googleapis.com/envoy.extensions.filters.http.rbac.v3.RBACPerRoute
        rbac:
          matcher:
            matcherList:
              matchers:
                - onMatch:
                    action:
                      name: envoy.filters.rbac.action
                      typedConfig:
                        '@type': type.googleapis.com/envoy.config.rbac.v3.Action
                        action: DENY
                        name: deny-request
                  predicate:
                    orMatcher:
                      predicate:
                        - singlePredicate:
                            customMatch:
                              name: envoy.matching.matchers.cel_matcher
                              typedConfig:
                                '@type': type.googleapis.com/xds.type.matcher.v3.CelMatcher
                                exprMatch:
                                  celExprParsed:
                                    expr:
                                      callExpr:
                                        args:
                                          - callExpr:
                                              args:
                                                - id: "2"
                                                  selectExpr:
                                                    field: headers
                                                    operand:
                                                      id: "1"
                                                      identExpr:
                                                        name: request
                                                - constExpr:
                                                    stringValue: x-foo
                                                  id: "4"
                                              function: _[_]
                                            id: "3"
                                          - constExpr:
                                              stringValue: bar
                                            id: "6"
                                        function: _==_
                                      id: "5"
                                    sourceInfo:
                                      lineOffsets:
                                        - 34
                                      location: <input>
                                      positions:
                                        "1": 0
                                        "2": 7
                                        "3": 15
                                        "4": 16
                                        "5": 25
                                        "6": 28
                            input:
                              name: envoy.matching.inputs.cel_data_input
                              typedConfig:
                                '@type': type.googleapis.com/xds.type.matcher.v3.HttpAttributesCelMatchInput
                        - singlePredicate:
                            customMatch:
                              name: envoy.matching.matchers.cel_matcher
                              typedConfig:
                                '@type': type.googleapis.com/xds.type.matcher.v3.CelMatcher
                                exprMatch:
                                  celExprParsed:
                                    expr:
                                      callExpr:
                                        args:
                                          - callExpr:
                                              args:
                                                - id: "2"
                                                  selectExpr:
                                                    field: headers
                                                    operand:
                                                      id: "1"
                                                      identExpr:
                                                        name: request
                                                - constExpr:
                                                    stringValue: x-bar
                                                  id: "4"
                                              function: _[_]
                                            id: "3"
                                          - constExpr:
                                              stringValue: foo
                                            id: "6"
                                        function: _==_
                                      id: "5"
                                    sourceInfo:
                                      lineOffsets:
                                        - 34
                                      location: <input>
                                      positions:
                                        "1": 0
                                        "2": 7
                                        "3": 15
                                        "4": 16
                                        "5": 25
                                        "6": 28
                            input:
                              name: envoy.matching.inputs.cel_data_input
                              typedConfig:
                                '@type': type.googleapis.com/xds.type.matcher.v3.HttpAttributesCelMatchInput
            onNoMatch:
              action:
                name: action
                typedConfig:
                  '@type': type.googleapis.com/envoy.config.rbac.v3.Action
                  action: DENY
                  name: deny-request
    virtualHosts:
      - domains:
          - example.com
        name: listener~80~example_com
        routes:
          - match:
              pathSeparatedPrefix: /foo
            name: listener~80~example_com-route-0-httproute-example-route-default-0-0-matcher-0
            route:
              cluster: kube_default_example-svc_80
              clusterNotFoundResponseCode: INTERNAL_SERVER_ERROR
          - match:
              pathSeparatedPrefix: /bar
            name: listener~80~example_com-route-1-httproute-example-route-default-1-0-matcher-0
            route:
              cluster: kube_default_example-svc_80
              clusterNotFoundResponseCode: INTERNAL_SERVER_ERROR